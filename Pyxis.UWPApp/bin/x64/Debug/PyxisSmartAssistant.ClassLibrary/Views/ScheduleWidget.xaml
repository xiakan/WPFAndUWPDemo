<UserControl x:ConnectionId='1'
    x:Class="PyxisSmartAssistant.ClassLibrary.Views.ScheduleWidget"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="using:PyxisSmartAssistant.ClassLibrary.Helper"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:customControl="using:PyxisSmartAssistant.ClassLibrary.CustomControl"
    mc:Ignorable="d"
    d:DesignWidth="400"
    d:DesignHeight="200"    
                                         
    Padding="14"
    >


    <Grid>
        <Grid x:ConnectionId='2'                                                               >
            <FrameworkElement.Resources>
                <SolidColorBrush x:Key="SystemControlHighlightAccentBrush">#00000000</SolidColorBrush>
            </FrameworkElement.Resources>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="1*"/>
                <ColumnDefinition Width="1.5*"/>
            </Grid.ColumnDefinitions>

            <!--日历-->
            <Viewbox VerticalAlignment="Top" Margin="20">
                <local:CalendarViewHelper x:ConnectionId='14'
            x:Name="CalendarView"   
            FirstDayOfWeek="Monday"
            SelectionMode="Single"
            BorderThickness="0"
            Background="{ThemeResource AppBackground}"
            BorderBrush="{x:Null}"
            IsOutOfScopeEnabled="False"
            TodayForeground="{x:Null}"
                    
            
            SelectedPressedBorderBrush="{x:Null}"
            SelectedHoverBorderBrush="{x:Null}"
            SelectedForeground="{x:Null}"
            SelectedBorderBrush="{x:Null}"
            
            CalendarItemForeground="{ThemeResource SystemControlBackgroundBaseHighBrush}"
            CalendarItemBorderBrush="{x:Null}"
            CalendarItemBackground="{x:Null}"

            FocusBorderBrush="{x:Null}"
            HoverBorderBrush="{x:Null}"
            PressedBorderBrush="{x:Null}"
            PressedForeground="{x:Null}"

            BlackoutForeground="{x:Null}"
            OutOfScopeForeground="{x:Null}"    
            OutOfScopeBackground="{x:Null}"                            
                                                                                             
                                                                                  
            >
                    <FrameworkElement.Style>
                        <Style TargetType="CalendarView">
                            <Setter Property="Foreground" Value="#6450E7"/>
                            <Setter Property="DayItemFontFamily" Value="XamlAutoFontFamily" />
                            <Setter Property="FirstOfMonthLabelFontFamily" Value="XamlAutoFontFamily" />
                            <Setter Property="MonthYearItemFontFamily" Value="XamlAutoFontFamily" />
                            <Setter Property="FirstOfYearDecadeLabelFontFamily" Value="XamlAutoFontFamily" />
                            <Setter Property="CalendarItemBorderThickness" Value="2" />
                            <Setter Property="HorizontalAlignment" Value="Left" />
                            <Setter Property="VerticalAlignment" Value="Center" />
                            <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                            <Setter Property="VerticalContentAlignment" Value="Stretch" />
                            <Setter Property="IsTabStop" Value="False" />
                            <Setter Property="UseSystemFocusVisuals" Value="{StaticResource UseSystemFocusVisuals}" />
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="CalendarView">
                                        <Border BorderThickness="{TemplateBinding BorderThickness}" BorderBrush="{TemplateBinding BorderBrush}" Background="{TemplateBinding Background}" CornerRadius="{TemplateBinding CornerRadius}">
                                            <Border.Resources>
                                                <Style TargetType="TextBlock" x:Key="WeekDayNameStyle" BasedOn="{StaticResource CaptionTextBlockStyle}">
                                                    <Setter Property="HorizontalAlignment" Value="Center" />
                                                    <Setter Property="VerticalAlignment" Value="Center" />
                                                    <Setter Property="FontSize" Value="14" />
                                                </Style>
                                                <Style TargetType="Button" x:Key="NavigationButtonStyle">
                                                    <Setter Property="HorizontalAlignment" Value="Stretch" />
                                                    <Setter Property="VerticalAlignment" Value="Stretch" />
                                                    <Setter Property="UseSystemFocusVisuals" Value="{StaticResource UseSystemFocusVisuals}" />
                                                    <Setter Property="FontSize" Value="14" />
                                                    <Setter Property="BackgroundSizing" Value="OuterBorderEdge" />
                                                    <Setter Property="Template">
                                                        <Setter.Value>
                                                            <ControlTemplate TargetType="Button">
                                                                <ContentPresenter x:Name="Text"
                      
                          BackgroundSizing="{TemplateBinding BackgroundSizing}"
                          BorderThickness="{TemplateBinding BorderThickness}"
                          Background="Transparent"
                          Content="{TemplateBinding Content}"
                          Margin="{TemplateBinding Padding}"
                          HorizontalContentAlignment="{TemplateBinding HorizontalContentAlignment}"
                          VerticalContentAlignment="{TemplateBinding VerticalContentAlignment}"
                          AutomationProperties.AccessibilityView="Raw">

                                                                    <VisualStateManager.VisualStateGroups>
                                                                        <VisualStateGroup x:Name="CommonStates">
                                                                            <VisualState x:Name="Normal" />

                                                                            <VisualState x:Name="PointerOver">
                                                                                <VisualState.Setters>

                                                                                </VisualState.Setters>
                                                                            </VisualState>

                                                                            <VisualState x:Name="Pressed">
                                                                                <VisualState.Setters>
                                                                                </VisualState.Setters>
                                                                            </VisualState>
                                                                            <VisualState x:Name="Disabled" />
                                                                        </VisualStateGroup>
                                                                    </VisualStateManager.VisualStateGroups>
                                                                </ContentPresenter>
                                                            </ControlTemplate>
                                                        </Setter.Value>
                                                    </Setter>
                                                </Style>
                                                <Style TargetType="ScrollViewer" x:Key="ScrollViewerStyle">
                                                    <Setter Property="HorizontalScrollMode" Value="Disabled" />
                                                    <Setter Property="VerticalScrollMode" Value="Disabled" />
                                                    <Setter Property="VerticalSnapPointsType" Value="Optional" />
                                                    <Setter Property="ZoomMode" Value="Disabled" />
                                                    <Setter Property="TabNavigation" Value="Once" />
                                                    <Setter Property="BringIntoViewOnFocusChange" Value="False" />
                                                    <Setter Property="Template" Value="{StaticResource ScrollViewerScrollBarlessTemplate}" />
                                                </Style>
                                            </Border.Resources>

                                            <VisualStateManager.VisualStateGroups>
                                                <VisualStateGroup x:Name="CommonStates">
                                                    <VisualState x:Name="Normal" />

                                                    <VisualState x:Name="Disabled">

                                                        <Storyboard>
                                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="WeekDay1" Storyboard.TargetProperty="Foreground">
                                                                <DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource CalendarViewWeekDayForegroundDisabled}" />
                                                            </ObjectAnimationUsingKeyFrames>
                                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="WeekDay2" Storyboard.TargetProperty="Foreground">
                                                                <DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource CalendarViewWeekDayForegroundDisabled}" />
                                                            </ObjectAnimationUsingKeyFrames>
                                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="WeekDay3" Storyboard.TargetProperty="Foreground">
                                                                <DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource CalendarViewWeekDayForegroundDisabled}" />
                                                            </ObjectAnimationUsingKeyFrames>
                                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="WeekDay4" Storyboard.TargetProperty="Foreground">
                                                                <DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource CalendarViewWeekDayForegroundDisabled}" />
                                                            </ObjectAnimationUsingKeyFrames>
                                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="WeekDay5" Storyboard.TargetProperty="Foreground">
                                                                <DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource CalendarViewWeekDayForegroundDisabled}" />
                                                            </ObjectAnimationUsingKeyFrames>
                                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="WeekDay6" Storyboard.TargetProperty="Foreground">
                                                                <DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource CalendarViewWeekDayForegroundDisabled}" />
                                                            </ObjectAnimationUsingKeyFrames>
                                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="WeekDay7" Storyboard.TargetProperty="Foreground">
                                                                <DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource CalendarViewWeekDayForegroundDisabled}" />
                                                            </ObjectAnimationUsingKeyFrames>
                                                        </Storyboard>
                                                    </VisualState>

                                                </VisualStateGroup>
                                                <VisualStateGroup x:Name="HeaderButtonStates">
                                                    <VisualState x:Name="ViewChanged" />
                                                    <VisualState x:Name="ViewChanging">

                                                        <Storyboard>
                                                            <DoubleAnimation Storyboard.TargetName="HeaderButton"
                    Storyboard.TargetProperty="Opacity"
                    From="0"
                    To="1"
                    Duration="0:0:0.167" />
                                                        </Storyboard>
                                                    </VisualState>

                                                </VisualStateGroup>
                                                <VisualStateGroup x:Name="DisplayModeStates">
                                                    <VisualState x:Name="Month" />
                                                    <VisualState x:Name="Year">

                                                        <Storyboard>
                                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="MonthViewScrollViewer" Storyboard.TargetProperty="IsEnabled">
                                                                <DiscreteObjectKeyFrame KeyTime="0:0:0" Value="False" />
                                                            </ObjectAnimationUsingKeyFrames>
                                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="MonthView" Storyboard.TargetProperty="Opacity">
                                                                <DiscreteObjectKeyFrame KeyTime="0:0:0" Value="0" />
                                                            </ObjectAnimationUsingKeyFrames>
                                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="YearViewScrollViewer" Storyboard.TargetProperty="Visibility">
                                                                <DiscreteObjectKeyFrame KeyTime="0:0:0" Value="Visible" />
                                                            </ObjectAnimationUsingKeyFrames>
                                                        </Storyboard>
                                                    </VisualState>
                                                    <VisualState x:Name="Decade">

                                                        <Storyboard>
                                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="MonthViewScrollViewer" Storyboard.TargetProperty="IsEnabled">
                                                                <DiscreteObjectKeyFrame KeyTime="0:0:0" Value="False" />
                                                            </ObjectAnimationUsingKeyFrames>
                                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="MonthView" Storyboard.TargetProperty="Opacity">
                                                                <DiscreteObjectKeyFrame KeyTime="0:0:0" Value="0" />
                                                            </ObjectAnimationUsingKeyFrames>
                                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="DecadeViewScrollViewer" Storyboard.TargetProperty="Visibility">
                                                                <DiscreteObjectKeyFrame KeyTime="0:0:0" Value="Visible" />
                                                            </ObjectAnimationUsingKeyFrames>
                                                        </Storyboard>
                                                    </VisualState>

                                                    <VisualStateGroup.Transitions>
                                                        <VisualTransition From="Month" To="Year">

                                                            <Storyboard>
                                                                <ObjectAnimationUsingKeyFrames Storyboard.TargetName="YearViewScrollViewer" Storyboard.TargetProperty="Visibility">
                                                                    <DiscreteObjectKeyFrame KeyTime="0" Value="Visible" />
                                                                </ObjectAnimationUsingKeyFrames>
                                                                <DoubleAnimationUsingKeyFrames Storyboard.TargetName="MonthView" Storyboard.TargetProperty="Opacity">
                                                                    <SplineDoubleKeyFrame KeyTime="0:0:0.233" Value="0" KeySpline="0.1,0.9,0.2,1" />
                                                                </DoubleAnimationUsingKeyFrames>
                                                                <DoubleAnimationUsingKeyFrames Storyboard.TargetName="YearViewScrollViewer" Storyboard.TargetProperty="Opacity">
                                                                    <DiscreteDoubleKeyFrame KeyTime="0" Value="0" />
                                                                    <DiscreteDoubleKeyFrame KeyTime="0:0:0.233" Value="0" />
                                                                    <SplineDoubleKeyFrame KeyTime="0:0:0.733" Value="1" KeySpline="0.1,0.9,0.2,1" />
                                                                </DoubleAnimationUsingKeyFrames>
                                                                <DoubleAnimationUsingKeyFrames Storyboard.TargetName="MonthViewTransform" Storyboard.TargetProperty="ScaleX">
                                                                    <SplineDoubleKeyFrame KeyTime="0:0:0.233" Value="0.84" KeySpline="0.1,0.9,0.2,1" />
                                                                </DoubleAnimationUsingKeyFrames>
                                                                <DoubleAnimationUsingKeyFrames Storyboard.TargetName="MonthViewTransform" Storyboard.TargetProperty="ScaleY">
                                                                    <SplineDoubleKeyFrame KeyTime="0:0:0.233" Value="0.84" KeySpline="0.1,0.9,0.2,1" />
                                                                </DoubleAnimationUsingKeyFrames>
                                                                <DoubleAnimationUsingKeyFrames Storyboard.TargetName="YearViewTransform" Storyboard.TargetProperty="ScaleX">
                                                                    <DiscreteDoubleKeyFrame KeyTime="0:0:0.233" Value="1.29" />
                                                                    <SplineDoubleKeyFrame KeyTime="0:0:0.733" Value="1" KeySpline="0.1,0.9,0.2,1" />
                                                                </DoubleAnimationUsingKeyFrames>
                                                                <DoubleAnimationUsingKeyFrames Storyboard.TargetName="YearViewTransform" Storyboard.TargetProperty="ScaleY">
                                                                    <DiscreteDoubleKeyFrame KeyTime="0:0:0.233" Value="1.29" />
                                                                    <SplineDoubleKeyFrame KeyTime="0:0:0.733" Value="1" KeySpline="0.1,0.9,0.2,1" />
                                                                </DoubleAnimationUsingKeyFrames>
                                                                <DoubleAnimationUsingKeyFrames Storyboard.TargetName="BackgroundLayer" Storyboard.TargetProperty="Opacity">
                                                                    <LinearDoubleKeyFrame KeyTime="0:0:0.000" Value="0" />
                                                                    <LinearDoubleKeyFrame KeyTime="0:0:0.250" Value="0" />
                                                                    <SplineDoubleKeyFrame KeyTime="0:0:0.733" Value="1" KeySpline="0.15,0.64,0.25,1" />
                                                                </DoubleAnimationUsingKeyFrames>
                                                            </Storyboard>
                                                        </VisualTransition>
                                                        <VisualTransition From="Year" To="Month">

                                                            <Storyboard>
                                                                <ObjectAnimationUsingKeyFrames Storyboard.TargetName="YearViewScrollViewer" Storyboard.TargetProperty="IsHitTestVisible">
                                                                    <DiscreteObjectKeyFrame KeyTime="0" Value="False" />
                                                                </ObjectAnimationUsingKeyFrames>
                                                                <ObjectAnimationUsingKeyFrames Storyboard.TargetName="YearViewScrollViewer" Storyboard.TargetProperty="Visibility">
                                                                    <DiscreteObjectKeyFrame KeyTime="0:0:0" Value="Visible" />
                                                                </ObjectAnimationUsingKeyFrames>
                                                                <DoubleAnimationUsingKeyFrames Storyboard.TargetName="YearViewScrollViewer" Storyboard.TargetProperty="Opacity">
                                                                    <SplineDoubleKeyFrame KeyTime="0:0:0.233" Value="0" KeySpline="0.1,0.9,0.2,1" />
                                                                </DoubleAnimationUsingKeyFrames>
                                                                <DoubleAnimationUsingKeyFrames Storyboard.TargetName="MonthView" Storyboard.TargetProperty="Opacity">
                                                                    <DiscreteDoubleKeyFrame KeyTime="0" Value="0" />
                                                                    <DiscreteDoubleKeyFrame KeyTime="0:0:0.233" Value="0" />
                                                                    <SplineDoubleKeyFrame KeyTime="0:0:0.733" Value="1" KeySpline="0.1,0.9,0.2,1" />
                                                                </DoubleAnimationUsingKeyFrames>
                                                                <DoubleAnimationUsingKeyFrames Storyboard.TargetName="YearViewTransform" Storyboard.TargetProperty="ScaleX">
                                                                    <SplineDoubleKeyFrame KeyTime="0:0:0.233" Value="1.29" KeySpline="0.1,0.9,0.2,1" />
                                                                </DoubleAnimationUsingKeyFrames>
                                                                <DoubleAnimationUsingKeyFrames Storyboard.TargetName="YearViewTransform" Storyboard.TargetProperty="ScaleY">
                                                                    <SplineDoubleKeyFrame KeyTime="0:0:0.233" Value="1.29" KeySpline="0.1,0.9,0.2,1" />
                                                                </DoubleAnimationUsingKeyFrames>
                                                                <DoubleAnimationUsingKeyFrames Storyboard.TargetName="MonthViewTransform" Storyboard.TargetProperty="ScaleX">
                                                                    <DiscreteDoubleKeyFrame KeyTime="0:0:0.233" Value="0.84" />
                                                                    <SplineDoubleKeyFrame KeyTime="0:0:0.733" Value="1" KeySpline="0.1,0.9,0.2,1" />
                                                                </DoubleAnimationUsingKeyFrames>
                                                                <DoubleAnimationUsingKeyFrames Storyboard.TargetName="MonthViewTransform" Storyboard.TargetProperty="ScaleY">
                                                                    <DiscreteDoubleKeyFrame KeyTime="0:0:0.233" Value="0.84" />
                                                                    <SplineDoubleKeyFrame KeyTime="0:0:0.733" Value="1" KeySpline="0.1,0.9,0.2,1" />
                                                                </DoubleAnimationUsingKeyFrames>
                                                                <DoubleAnimationUsingKeyFrames Storyboard.TargetName="BackgroundTransform" Storyboard.TargetProperty="ScaleX">
                                                                    <DiscreteDoubleKeyFrame KeyTime="0:0:0.233" Value="0.84" />
                                                                    <SplineDoubleKeyFrame KeyTime="0:0:0.733" Value="1" KeySpline="0.1,0.9,0.2,1" />
                                                                </DoubleAnimationUsingKeyFrames>
                                                                <DoubleAnimationUsingKeyFrames Storyboard.TargetName="BackgroundTransform" Storyboard.TargetProperty="ScaleY">
                                                                    <DiscreteDoubleKeyFrame KeyTime="0:0:0.233" Value="0.84" />
                                                                    <SplineDoubleKeyFrame KeyTime="0:0:0.733" Value="1" KeySpline="0.1,0.9,0.2,1" />
                                                                </DoubleAnimationUsingKeyFrames>
                                                                <DoubleAnimationUsingKeyFrames Storyboard.TargetName="BackgroundLayer" Storyboard.TargetProperty="Opacity">
                                                                    <LinearDoubleKeyFrame KeyTime="0:0:0.000" Value="0" />
                                                                    <LinearDoubleKeyFrame KeyTime="0:0:0.250" Value="0" />
                                                                    <SplineDoubleKeyFrame KeyTime="0:0:0.733" Value="1" KeySpline="0.15,0.64,0.25,1" />
                                                                </DoubleAnimationUsingKeyFrames>
                                                            </Storyboard>
                                                        </VisualTransition>
                                                        <VisualTransition From="Year" To="Decade">

                                                            <Storyboard>
                                                                <DoubleAnimationUsingKeyFrames Storyboard.TargetName="MonthView" Storyboard.TargetProperty="Opacity">
                                                                    <DiscreteDoubleKeyFrame KeyTime="0" Value="0" />
                                                                </DoubleAnimationUsingKeyFrames>
                                                                <ObjectAnimationUsingKeyFrames Storyboard.TargetName="YearViewScrollViewer" Storyboard.TargetProperty="Visibility">
                                                                    <DiscreteObjectKeyFrame KeyTime="0:0:0" Value="Visible" />
                                                                </ObjectAnimationUsingKeyFrames>
                                                                <ObjectAnimationUsingKeyFrames Storyboard.TargetName="DecadeViewScrollViewer" Storyboard.TargetProperty="Visibility">
                                                                    <DiscreteObjectKeyFrame KeyTime="0:0:0" Value="Visible" />
                                                                </ObjectAnimationUsingKeyFrames>
                                                                <DoubleAnimationUsingKeyFrames Storyboard.TargetName="YearViewScrollViewer" Storyboard.TargetProperty="Opacity">
                                                                    <SplineDoubleKeyFrame KeyTime="0:0:0.233" Value="0" KeySpline="0.1,0.9,0.2,1" />
                                                                </DoubleAnimationUsingKeyFrames>
                                                                <DoubleAnimationUsingKeyFrames Storyboard.TargetName="DecadeViewScrollViewer" Storyboard.TargetProperty="Opacity">
                                                                    <DiscreteDoubleKeyFrame KeyTime="0" Value="0" />
                                                                    <DiscreteDoubleKeyFrame KeyTime="0:0:0.233" Value="0" />
                                                                    <SplineDoubleKeyFrame KeyTime="0:0:0.733" Value="1" KeySpline="0.1,0.9,0.2,1" />
                                                                </DoubleAnimationUsingKeyFrames>
                                                                <DoubleAnimationUsingKeyFrames Storyboard.TargetName="YearViewTransform" Storyboard.TargetProperty="ScaleX">
                                                                    <SplineDoubleKeyFrame KeyTime="0:0:0.233" Value="0.84" KeySpline="0.1,0.9,0.2,1" />
                                                                </DoubleAnimationUsingKeyFrames>
                                                                <DoubleAnimationUsingKeyFrames Storyboard.TargetName="YearViewTransform" Storyboard.TargetProperty="ScaleY">
                                                                    <SplineDoubleKeyFrame KeyTime="0:0:0.233" Value="0.84" KeySpline="0.1,0.9,0.2,1" />
                                                                </DoubleAnimationUsingKeyFrames>
                                                                <DoubleAnimationUsingKeyFrames Storyboard.TargetName="DecadeViewTransform" Storyboard.TargetProperty="ScaleX">
                                                                    <DiscreteDoubleKeyFrame KeyTime="0:0:0.233" Value="1.29" />
                                                                    <SplineDoubleKeyFrame KeyTime="0:0:0.733" Value="1" KeySpline="0.1,0.9,0.2,1" />
                                                                </DoubleAnimationUsingKeyFrames>
                                                                <DoubleAnimationUsingKeyFrames Storyboard.TargetName="DecadeViewTransform" Storyboard.TargetProperty="ScaleY">
                                                                    <DiscreteDoubleKeyFrame KeyTime="0:0:0.233" Value="1.29" />
                                                                    <SplineDoubleKeyFrame KeyTime="0:0:0.733" Value="1" KeySpline="0.1,0.9,0.2,1" />
                                                                </DoubleAnimationUsingKeyFrames>
                                                                <DoubleAnimationUsingKeyFrames Storyboard.TargetName="BackgroundLayer" Storyboard.TargetProperty="Opacity">
                                                                    <LinearDoubleKeyFrame KeyTime="0:0:0.000" Value="0" />
                                                                    <LinearDoubleKeyFrame KeyTime="0:0:0.250" Value="0" />
                                                                    <SplineDoubleKeyFrame KeyTime="0:0:0.733" Value="1" KeySpline="0.15,0.64,0.25,1" />
                                                                </DoubleAnimationUsingKeyFrames>
                                                            </Storyboard>
                                                        </VisualTransition>
                                                        <VisualTransition From="Decade" To="Year">

                                                            <Storyboard>
                                                                <DoubleAnimationUsingKeyFrames Storyboard.TargetName="MonthView" Storyboard.TargetProperty="Opacity">
                                                                    <DiscreteDoubleKeyFrame KeyTime="0" Value="0" />
                                                                </DoubleAnimationUsingKeyFrames>
                                                                <ObjectAnimationUsingKeyFrames Storyboard.TargetName="YearViewScrollViewer" Storyboard.TargetProperty="Visibility">
                                                                    <DiscreteObjectKeyFrame KeyTime="0:0:0" Value="Visible" />
                                                                </ObjectAnimationUsingKeyFrames>
                                                                <ObjectAnimationUsingKeyFrames Storyboard.TargetName="DecadeViewScrollViewer" Storyboard.TargetProperty="Visibility">
                                                                    <DiscreteObjectKeyFrame KeyTime="0:0:0" Value="Visible" />
                                                                </ObjectAnimationUsingKeyFrames>
                                                                <ObjectAnimationUsingKeyFrames Storyboard.TargetName="DecadeViewScrollViewer" Storyboard.TargetProperty="IsHitTestVisible">
                                                                    <DiscreteObjectKeyFrame KeyTime="0" Value="False" />
                                                                </ObjectAnimationUsingKeyFrames>
                                                                <DoubleAnimationUsingKeyFrames Storyboard.TargetName="DecadeViewScrollViewer" Storyboard.TargetProperty="Opacity">
                                                                    <SplineDoubleKeyFrame KeyTime="0:0:0.233" Value="0" KeySpline="0.1,0.9,0.2,1" />
                                                                </DoubleAnimationUsingKeyFrames>
                                                                <DoubleAnimationUsingKeyFrames Storyboard.TargetName="YearViewScrollViewer" Storyboard.TargetProperty="Opacity">
                                                                    <DiscreteDoubleKeyFrame KeyTime="0" Value="0" />
                                                                    <DiscreteDoubleKeyFrame KeyTime="0:0:0.233" Value="0" />
                                                                    <SplineDoubleKeyFrame KeyTime="0:0:0.733" Value="1" KeySpline="0.1,0.9,0.2,1" />
                                                                </DoubleAnimationUsingKeyFrames>
                                                                <DoubleAnimationUsingKeyFrames Storyboard.TargetName="DecadeViewTransform" Storyboard.TargetProperty="ScaleX">
                                                                    <SplineDoubleKeyFrame KeyTime="0:0:0.233" Value="1.29" KeySpline="0.1,0.9,0.2,1" />
                                                                </DoubleAnimationUsingKeyFrames>
                                                                <DoubleAnimationUsingKeyFrames Storyboard.TargetName="DecadeViewTransform" Storyboard.TargetProperty="ScaleY">
                                                                    <SplineDoubleKeyFrame KeyTime="0:0:0.233" Value="1.29" KeySpline="0.1,0.9,0.2,1" />
                                                                </DoubleAnimationUsingKeyFrames>
                                                                <DoubleAnimationUsingKeyFrames Storyboard.TargetName="YearViewTransform" Storyboard.TargetProperty="ScaleX">
                                                                    <DiscreteDoubleKeyFrame KeyTime="0:0:0.233" Value="0.84" />
                                                                    <SplineDoubleKeyFrame KeyTime="0:0:0.733" Value="1" KeySpline="0.1,0.9,0.2,1" />
                                                                </DoubleAnimationUsingKeyFrames>
                                                                <DoubleAnimationUsingKeyFrames Storyboard.TargetName="YearViewTransform" Storyboard.TargetProperty="ScaleY">
                                                                    <DiscreteDoubleKeyFrame KeyTime="0:0:0.233" Value="0.84" />
                                                                    <SplineDoubleKeyFrame KeyTime="0:0:0.733" Value="1" KeySpline="0.1,0.9,0.2,1" />
                                                                </DoubleAnimationUsingKeyFrames>
                                                                <DoubleAnimationUsingKeyFrames Storyboard.TargetName="BackgroundTransform" Storyboard.TargetProperty="ScaleX">
                                                                    <DiscreteDoubleKeyFrame KeyTime="0:0:0.233" Value="0.84" />
                                                                    <SplineDoubleKeyFrame KeyTime="0:0:0.733" Value="1" KeySpline="0.1,0.9,0.2,1" />
                                                                </DoubleAnimationUsingKeyFrames>
                                                                <DoubleAnimationUsingKeyFrames Storyboard.TargetName="BackgroundTransform" Storyboard.TargetProperty="ScaleY">
                                                                    <DiscreteDoubleKeyFrame KeyTime="0:0:0.233" Value="0.84" />
                                                                    <SplineDoubleKeyFrame KeyTime="0:0:0.733" Value="1" KeySpline="0.1,0.9,0.2,1" />
                                                                </DoubleAnimationUsingKeyFrames>
                                                                <DoubleAnimationUsingKeyFrames Storyboard.TargetName="BackgroundLayer" Storyboard.TargetProperty="Opacity">
                                                                    <LinearDoubleKeyFrame KeyTime="0:0:0.000" Value="0" />
                                                                    <LinearDoubleKeyFrame KeyTime="0:0:0.250" Value="0" />
                                                                    <SplineDoubleKeyFrame KeyTime="0:0:0.733" Value="1" KeySpline="0.15,0.64,0.25,1" />
                                                                </DoubleAnimationUsingKeyFrames>
                                                            </Storyboard>
                                                        </VisualTransition>
                                                    </VisualStateGroup.Transitions>

                                                </VisualStateGroup>

                                            </VisualStateManager.VisualStateGroups>
                                            <Grid VerticalAlignment="{TemplateBinding VerticalContentAlignment}" HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" MinWidth="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=TemplateSettings.MinViewWidth}">

                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="40" />
                                                    <RowDefinition Height="*" />
                                                </Grid.RowDefinitions>
                                                <Grid>

                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="*" />
                                                        <ColumnDefinition Width="5*" />
                                                        <ColumnDefinition Width="*" />
                                                    </Grid.ColumnDefinitions>
                                                    <local:CalendarViewHeaderButton 
                                                        x:Name="HeaderButton" 
                                                        IsHitTestVisible="False"
                                                        Grid.Column="1"
                                                        FontWeight="Medium"
                                                        Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=TemplateSettings.HeaderText}"
                                                        IsEnabled="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=TemplateSettings.HasMoreViews}"
                                                        Style="{StaticResource NavigationButtonStyle}"                                                        
                                                        Foreground="{TemplateBinding Foreground}"
                                                        FontSize="18px"
                                                        Padding="12,0,0,0"
                                                        HorizontalContentAlignment="Center" />
                                                    <Button x:Name="PreviousButton"
                                                        Grid.Column="0"
                                                        Content="&#xE00E;"
                                                        FontWeight="Bold"
                                                        FontFamily="{ThemeResource SymbolThemeFontFamily}"
                                                        FontSize="16px"
                                                        IsTabStop="True"
                                                        Padding="1"                                                            
                                                        Foreground="{TemplateBinding Foreground}"
                                                        HorizontalContentAlignment="Center"
                                                        IsEnabled="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=TemplateSettings.HasMoreContentBefore}"
                                                        Style="{StaticResource NavigationButtonStyle}" />
                                                    <Button x:Name="NextButton"
                                                        Grid.Column="2"
                                                        Content="&#xE00F;"
                                                        FontWeight="Bold"
                                                        FontFamily="{ThemeResource SymbolThemeFontFamily}"
                                                        FontSize="16px"
                                                        IsTabStop="True"
                                                        Padding="1"
                                                        Foreground="{TemplateBinding Foreground}"
                                                        HorizontalContentAlignment="Center"
                                                        IsEnabled="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=TemplateSettings.HasMoreContentAfter}"
                                                        Style="{StaticResource NavigationButtonStyle}" />
                                                </Grid>
                                                <Grid x:Name="Views" Grid.Row="1">
                                                    <Grid.Clip>
                                                        <RectangleGeometry Rect="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=TemplateSettings.ClipRect}" />
                                                    </Grid.Clip>
                                                    <Border x:Name="BackgroundLayer" Background="{TemplateBinding BorderBrush}">
                                                        <Border.RenderTransform>
                                                            <ScaleTransform x:Name="BackgroundTransform" CenterX="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=TemplateSettings.CenterX}" CenterY="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=TemplateSettings.CenterY}" />
                                                        </Border.RenderTransform>
                                                    </Border>
                                                    <Grid x:Name="MonthView">
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="38" />
                                                            <RowDefinition Height="*" />
                                                        </Grid.RowDefinitions>
                                                        <Grid.RenderTransform>
                                                            <ScaleTransform x:Name="MonthViewTransform" CenterX="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=TemplateSettings.CenterX}" CenterY="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=TemplateSettings.CenterY}" />
                                                        </Grid.RenderTransform>
                                                        <Grid x:Name="WeekDayNames" Opacity="0.4" Background="{TemplateBinding Background}">
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="*" />
                                                                <ColumnDefinition Width="*" />
                                                                <ColumnDefinition Width="*" />
                                                                <ColumnDefinition Width="*" />
                                                                <ColumnDefinition Width="*" />
                                                                <ColumnDefinition Width="*" />
                                                                <ColumnDefinition Width="*" />
                                                            </Grid.ColumnDefinitions>
                                                            <TextBlock Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=TemplateSettings.WeekDay1}"
                        x:Name="WeekDay1"
                        Foreground="{TemplateBinding CalendarItemForeground}"                         
                        Style="{StaticResource WeekDayNameStyle}" />
                                                            <TextBlock Grid.Column="1"
                        Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=TemplateSettings.WeekDay2}"
                        x:Name="WeekDay2"
                        Foreground="{TemplateBinding CalendarItemForeground}"                         
                        Style="{StaticResource WeekDayNameStyle}" />
                                                            <TextBlock Grid.Column="2"
                        Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=TemplateSettings.WeekDay3}"
                        x:Name="WeekDay3"
                        Foreground="{TemplateBinding CalendarItemForeground}"
                        Style="{StaticResource WeekDayNameStyle}" />
                                                            <TextBlock Grid.Column="3"
                        Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=TemplateSettings.WeekDay4}"
                        x:Name="WeekDay4"
                        Foreground="{TemplateBinding CalendarItemForeground}"
                        Style="{StaticResource WeekDayNameStyle}" />
                                                            <TextBlock Grid.Column="4"
                        Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=TemplateSettings.WeekDay5}"
                        x:Name="WeekDay5"
                        Foreground="{TemplateBinding CalendarItemForeground}"
                        Style="{StaticResource WeekDayNameStyle}" />
                                                            <TextBlock Grid.Column="5"
                        Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=TemplateSettings.WeekDay6}"
                        x:Name="WeekDay6"
                        Foreground="{TemplateBinding CalendarItemForeground}"
                        Style="{StaticResource WeekDayNameStyle}" />
                                                            <TextBlock Grid.Column="6"
                        Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=TemplateSettings.WeekDay7}"
                        x:Name="WeekDay7"
                        Foreground="{TemplateBinding CalendarItemForeground}"
                        Style="{StaticResource WeekDayNameStyle}" />
                                                        </Grid>
                                                        <ScrollViewer x:Name="MonthViewScrollViewer" Grid.Row="1" Style="{StaticResource ScrollViewerStyle}" IsFocusEngagementEnabled="True">
                                                            <CalendarPanel x:Name="MonthViewPanel" />
                                                        </ScrollViewer>

                                                    </Grid>
                                                    <ScrollViewer x:Name="YearViewScrollViewer"
                    UseLayoutRounding="False"
                    Visibility="Collapsed"
                    IsFocusEngagementEnabled="True"
                    Style="{StaticResource ScrollViewerStyle}">
                                                        <ScrollViewer.RenderTransform>
                                                            <ScaleTransform x:Name="YearViewTransform" CenterX="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=TemplateSettings.CenterX}" CenterY="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=TemplateSettings.CenterY}" />
                                                        </ScrollViewer.RenderTransform>
                                                        <CalendarPanel x:Name="YearViewPanel" />
                                                    </ScrollViewer>
                                                    <ScrollViewer x:Name="DecadeViewScrollViewer"
                    UseLayoutRounding="False"
                    IsFocusEngagementEnabled="True"
                    Visibility="Collapsed"
                    Style="{StaticResource ScrollViewerStyle}">
                                                        <ScrollViewer.RenderTransform>
                                                            <ScaleTransform x:Name="DecadeViewTransform" CenterX="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=TemplateSettings.CenterX}" CenterY="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=TemplateSettings.CenterY}" />
                                                        </ScrollViewer.RenderTransform>
                                                        <CalendarPanel x:Name="DecadeViewPanel" />
                                                    </ScrollViewer>
                                                </Grid>

                                            </Grid>
                                        </Border>

                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </FrameworkElement.Style>
                </local:CalendarViewHelper>
            </Viewbox>

            <!--日程-->
            <Grid x:ConnectionId='9' x:Name="gridCalendarList" Grid.Column="1" >
                <FrameworkElement.Resources>
                    <SolidColorBrush x:Key="SystemControlHighlightAccentBrush">#6450E7</SolidColorBrush>
                </FrameworkElement.Resources>

                <Grid.RowDefinitions>
                    <RowDefinition Height="55"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                <!--日程标题-->
                <TextBlock x:ConnectionId='10' x:Name="txtScheduleTitle"
                           Foreground="{StaticResource SystemControlHighlightAccentBrush}" FontSize="14" 
                           Margin="25 25 0 10">
                </TextBlock>

                <!--无日程-->
                <StackPanel x:ConnectionId='11' Grid.Row="1" VerticalAlignment="Center"                                                       >
                    <Border CornerRadius="60" Width="120" Height="120" Background="{ThemeResource AppOverlayTipBackground}">
                        <Image HorizontalAlignment="Center" VerticalAlignment="Center" >
                            <Image.Source>
                                ms-appx:///Images/noSchedule.png
                            </Image.Source>
                        </Image>
                    </Border>
                    <ContentControl Height="18"/>
                    <TextBlock HorizontalAlignment="Center" Text="{StaticResource WonderBar_NoSchedule}">
                        <!--NoSchedule-->
                    </TextBlock>
                </StackPanel>

                <!--日程列表-->
                <ListView x:ConnectionId='12' x:Name="ListView"                         
                                                                                        
                          Grid.Row="1"            
                          IsItemClickEnabled="True"             
                          SelectionMode="None"                  
                                                                                      
                          >
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <Grid Height="68">
                                <Grid.RowDefinitions>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="auto"/>
                                    <ColumnDefinition/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Row="0" Grid.Column="0" HorizontalAlignment="Left" VerticalAlignment="Center"
                                           Text="{Binding ScheduleStartTime}" FontSize="16" Margin="20 0 20 5"/>

                                <TextBlock Grid.Row="0" Grid.Column="1" HorizontalAlignment="Left" VerticalAlignment="Center"
                                           Text="{Binding Subject}" FontSize="16" Margin="10 0 20 5"
                                           TextWrapping="NoWrap"
                                           TextTrimming="CharacterEllipsis"/>

                                <TextBlock Grid.Row="1" Grid.Column="0" HorizontalAlignment="Left" VerticalAlignment="Center"
                                           Text="{Binding ScheduleEndTime}" FontSize="16" Margin="20 5 20 10"/>

                                <TextBlock Grid.Row="1" Grid.Column="1" HorizontalAlignment="Left" VerticalAlignment="Center"
                                           Text="{Binding Location}" Foreground="Gray" FontSize="16" Margin="10 5 5 10" 
                                           TextWrapping="NoWrap"
                                           TextTrimming="CharacterEllipsis"/>
                            </Grid>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <VirtualizingStackPanel/>
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                </ListView>

            </Grid>
        </Grid>

        <!--NoInternet Top-->
        <Border x:ConnectionId='3' Grid.ColumnSpan="2"  x:Name="NoNetWorkBorder"  Height="40" Width="40" Margin="0,2" Background="Transparent" HorizontalAlignment="Right" VerticalAlignment="Top"
                Visibility="Collapsed">
            <Image HorizontalAlignment="Center" VerticalAlignment="Center" >
                <Image.Source>
                    ms-appx:///Images/NoInternetTop.png
                </Image.Source>
            </Image>
        </Border>

        <!--NoInstall-->
        <StackPanel x:ConnectionId='4' VerticalAlignment="Center"                                                      >
            <Border CornerRadius="60" Width="120" Height="120" Background="{ThemeResource AppOverlayTipBackground}">
                <Image HorizontalAlignment="Center" VerticalAlignment="Center" >
                    <Image.Source>
                        ms-appx:///Images/Outlook@2x.png
                    </Image.Source>
                </Image>
            </Border>
            <ContentControl Height="18"/>
            <TextBlock HorizontalAlignment="Center" Text="{StaticResource WonderBar_NoInstallSchedule}">
                <!--Install and login to your Outlook acount,and your calendar will show here-->
            </TextBlock>
        </StackPanel>

        <!--NoLogin-->
        <Button x:ConnectionId='5' x:Name="NoLoginButton" HorizontalAlignment="Center" VerticalAlignment="Center" BorderThickness="0" BorderBrush="Transparent" Background="Transparent" 
                                                                   >
            <StackPanel>
                <Border CornerRadius="60" Width="120" Height="120" Background="{ThemeResource AppOverlayTipBackground}">
                    <Image HorizontalAlignment="Center" VerticalAlignment="Center" >
                        <Image.Source>
                            ms-appx:///Images/Outlook@2x.png
                        </Image.Source>
                    </Image>
                </Border>
                <ContentControl Height="18"/>
                <TextBlock HorizontalAlignment="Center" Text="{StaticResource WonderBar_NoLoginSchedule}">
                    <!--Install and login to your Outlook acount,and your calendar will show here-->
                </TextBlock>
            </StackPanel>
        </Button>

        <!--Loading Top-->
        <Border x:ConnectionId='6' x:Name="LoadingBorder"
                Grid.Column="0" Grid.ColumnSpan="2"
                CornerRadius="10" 
                Background="{ThemeResource SystemControlBackgroundBaseHighBrush}"
                HorizontalAlignment="Right"
                VerticalAlignment="Top"
                Height="32"
                MinWidth="120"
                Margin="0 20 0 0"
                                                                     >
            <StackPanel Margin="8,0" Orientation="Horizontal" HorizontalAlignment="Center">
                <!--<customControl:ProgressRing Width="10" Height="10" Thickness="2" IsActive="True"/>-->
                <ProgressRing IsActive="True"/>
                <ContentControl Width="10"/>
                <TextBlock
                    FontSize="14" 
                    Foreground="{ThemeResource SystemControlBackgroundAltHighBrush}"
                    FontWeight="Bold" 
                    HorizontalAlignment="Center" 
                    VerticalAlignment="Center"
                    Text="{StaticResource WonderBar_Loading}"/>
            </StackPanel>
        </Border>

        <!--Loading-->
        <Border x:ConnectionId='7' x:Name="LoagingBorder"                                                     Background="{ThemeResource AppBackground}">
            <StackPanel  HorizontalAlignment="Center" VerticalAlignment="Center">
                <Border CornerRadius="60" Width="200" Height="120" Background="{ThemeResource AppBackground}">
                    <Image HorizontalAlignment="Center" VerticalAlignment="Center" >
                        <Image.Source>
                            ms-appx:///Images/Schedule_Loading.png
                        </Image.Source>
                    </Image>
                </Border>
                <ContentControl Height="12"/>
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                    <!--<customControl:ProgressRing Width="10" Height="10" Thickness="2" IsActive="{x:Bind LoadingToBooleanConverter(State), Mode=OneWay}"/>-->
                    <ProgressRing x:ConnectionId='8'                                                                  />
                    <ContentControl Width="10"/>
                    <TextBlock Text="{StaticResource Schedule_Loading}">
                        <!--Loading-->
                    </TextBlock>
                </StackPanel>
            </StackPanel>
        </Border>

    </Grid>
</UserControl>

